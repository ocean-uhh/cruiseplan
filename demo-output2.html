

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CruisePlan Demo &mdash; CruisePlan v0.3.1 v0.3.1.post1.dev4</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=393fce2e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=a368237d"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CruisePlan v0.3.1
              <img src="_static/cruise_plan_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Workflows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user_workflows.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_workflows.html#workflow-paths">Workflow Paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_workflows.html#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_workflows.html#troubleshooting">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebook Demo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="demo-output.html">CruisePlan Demo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Specifications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cruise_architecture.html">Cruise Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_reference.html">CLI Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="yaml_reference.html">YAML Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="operation_types.html">Operation Types Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculations.html">Calculation Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="units_and_defaults.html">Units and defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_ports.html">Port list</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_formats.html">Output formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help and Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocean-uhh/cruiseplan">GitHub Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocean-uhh/cruiseplan/blob/main/CONTRIBUTING.md">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_structure.html">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_testing.html">Manual Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap/index.html">Development Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap/index.html#implementation-notes">Implementation Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap/index.html#risk-assessment">Risk Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap/index.html#contributing">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CruisePlan v0.3.1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CruisePlan Demo</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="CruisePlan-Demo">
<h1>CruisePlan Demo<a class="headerlink" href="#CruisePlan-Demo" title="Link to this heading">ÔÉÅ</a></h1>
<p>This notebook demonstrates the complete CruisePlan workflow using Python functions rather than CLI commands. Each section corresponds to a CLI subcommand and shows how to accomplish the same tasks programmatically.</p>
<section id="Workflow-Overview">
<h2>Workflow Overview<a class="headerlink" href="#Workflow-Overview" title="Link to this heading">ÔÉÅ</a></h2>
<p>The data preparation phase includes steps 1 and 2, the cruise configuration is steps 3 and 4, and the scheduling is step 5.</p>
<ol class="arabic simple">
<li><p><strong>Bathymetry</strong>: Get bathymetry data for depth calculations</p></li>
<li><p><strong>Pangaea</strong>: Search PANGAEA database for relevant oceanographic datasets</p></li>
<li><p><strong>Stations</strong>: Interactive station planning (or programmatic configuration)</p></li>
<li><p><strong>Process</strong>: Enrich configuration with depths/coordinates + validate</p></li>
<li><p><strong>Schedule</strong>: Generate cruise timeline and outputs</p></li>
</ol>
<p>All outputs will be saved to <code class="docutils literal notranslate"><span class="pre">tests_output/demo/</span></code> for easy exploration.</p>
</section>
<section id="Setup-and-Imports">
<h2>Setup and Imports<a class="headerlink" href="#Setup-and-Imports" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Core imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cruiseplan</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cruiseplan.utils.global_ports</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">add_custom_port</span><span class="p">,</span>
    <span class="n">get_available_ports</span><span class="p">,</span>
    <span class="n">list_ports_in_region</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cruiseplan.utils.yaml_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">save_yaml</span>

<span class="c1"># Set up output directory</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../tests_output/demo&#39;</span><span class="p">)</span>
<span class="n">output_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Demo outputs will be saved to: </span><span class="si">{</span><span class="n">output_dir</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Configure logging to see what&#39;s happening</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Demo outputs will be saved to: /home/runner/work/cruiseplan/cruiseplan/notebooks/../tests_output/demo
</pre></div></div>
</div>
</section>
<section id="Phase-1:-Data-Preparation">
<h2>Phase 1: Data Preparation<a class="headerlink" href="#Phase-1:-Data-Preparation" title="Link to this heading">ÔÉÅ</a></h2>
<section id="Step-1:-Download-Bathymetry-Data">
<h3>Step 1: Download Bathymetry Data<a class="headerlink" href="#Step-1:-Download-Bathymetry-Data" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>CLI Equivalent</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cruiseplan<span class="w"> </span>bathymetry<span class="w"> </span>--bathy-source<span class="w"> </span>etopo2022
</pre></div>
</div>
<p>First, we need bathymetry data for depth calculations and visualization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize bathymetry manager with ETOPO2022 data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üì• Downloading bathymetry data...&quot;</span><span class="p">)</span>
<span class="n">bathy_result</span> <span class="o">=</span> <span class="n">cruiseplan</span><span class="o">.</span><span class="n">bathymetry</span><span class="p">(</span><span class="n">bathy_source</span><span class="o">=</span><span class="s2">&quot;etopo2022&quot;</span><span class="p">)</span>
<span class="n">bathy_path</span> <span class="o">=</span> <span class="n">bathy_result</span><span class="o">.</span><span class="n">data_file</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: =ÔøΩ Downloading etopo2022 bathymetry data to /home/runner/work/cruiseplan/cruiseplan/data/bathymetry
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
üì• Downloading bathymetry data...
Downloading ETOPO dataset to /home/runner/work/cruiseplan/cruiseplan/data/bathymetry/ETOPO_2022_v1_60s_N90W180_bed.nc...
Attempting download from: https://www.ngdc.noaa.gov/thredds/fileServer/global/ETOPO2022/60s/60s_bed_elev_netcdf/ETOPO_2022_v1_60s_N90W180_bed.nc
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading ETOPO: 469MB [00:56, 8.74MB/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Download complete!
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
</section>
<section id="Step-2:-Search-PANGAEA-Database">
<h3>Step 2: Search PANGAEA Database<a class="headerlink" href="#Step-2:-Search-PANGAEA-Database" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>CLI Equivalent</strong> (from root, rather than notebooks/ directory):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cruiseplan<span class="w"> </span>pangaea<span class="w"> </span><span class="s2">&quot;CTD&quot;</span><span class="w"> </span>--lat<span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">70</span><span class="w"> </span>--lon<span class="w"> </span>-60<span class="w"> </span>-30<span class="w"> </span>--limit<span class="w"> </span><span class="m">5</span><span class="w"> </span>--output-dir<span class="w"> </span>tests_output/demo<span class="w"> </span>--output<span class="w"> </span>demo<span class="sb">`</span>
</pre></div>
</div>
<p>Search for relevant oceanographic datasets to inform our cruise planning.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîç Searching PANGAEA database and downloading station data...&quot;</span><span class="p">)</span>

<span class="c1"># Define search parameters</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;CTD&quot;</span>  <span class="c1"># or &quot;CTD temperature North Atlantic&quot;</span>
<span class="n">lat_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>  <span class="c1"># min_lat, max_lat</span>
<span class="n">lon_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">]</span>  <span class="c1"># min_lon, max_lon</span>
<span class="n">limit</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Query: &#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Geographic bounds: 50¬∞N-70¬∞N, 60¬∞W-30¬∞W&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Limit: </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2"> datasets&quot;</span><span class="p">)</span>

<span class="c1"># Search and download in one step</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">pangaea_result</span> <span class="o">=</span> <span class="n">cruiseplan</span><span class="o">.</span><span class="n">pangaea</span><span class="p">(</span>
        <span class="n">query_terms</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">lat_bounds</span><span class="o">=</span><span class="n">lat_bounds</span><span class="p">,</span>
        <span class="n">lon_bounds</span><span class="o">=</span><span class="n">lon_bounds</span><span class="p">,</span>
        <span class="n">max_results</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span><span class="p">),</span>
        <span class="n">output</span><span class="o">=</span><span class="s2">&quot;demo&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Extract data from result</span>
    <span class="n">pangaea_stations</span> <span class="o">=</span> <span class="n">pangaea_result</span><span class="o">.</span><span class="n">stations_data</span>
    <span class="n">pangaea_files</span> <span class="o">=</span> <span class="n">pangaea_result</span><span class="o">.</span><span class="n">files_created</span>

    <span class="k">if</span> <span class="n">pangaea_files</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ PANGAEA processing completed!&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">pangaea_files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üìÑ </span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ùå No datasets found or processing failed&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå PANGAEA processing failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
üîç Searching PANGAEA database and downloading station data...
   Query: &#39;CTD&#39;
   Geographic bounds: 50¬∞N-70¬∞N, 60¬∞W-30¬∞W
   Limit: 5 datasets
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Failed to extract font properties from /usr/share/fonts/truetype/noto/NotoColorEmoji.ttf: Can not load face (unknown file format; error code 0x2)
INFO: generated new fontManager
INFO: üîç Searching PANGAEA for: &#39;CTD&#39;
INFO: üìç Geographic bounds: lat [50, 70], lon [-60, -30]
INFO: Search found 1826 total matches. Retrieving first 5...
INFO: ‚úÖ Found 5 datasets
INFO: üìÇ DOI file: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_dois.txt
INFO: üìÇ Stations file: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_stations.pkl
INFO: ‚öôÔ∏è Processing 5 DOIs...
INFO: üïê Rate limit: 1.0 requests/second
INFO: Fetching PANGAEA dataset: 10.1594/PANGAEA.755512
INFO: Fetching PANGAEA dataset: 10.1594/PANGAEA.604878
INFO: Fetching PANGAEA dataset: 10.1594/PANGAEA.604842
INFO: Fetching PANGAEA dataset: 10.1594/PANGAEA.604887
INFO: Fetching PANGAEA dataset: 10.1594/PANGAEA.604857
INFO: ‚úÖ PANGAEA processing completed successfully!
INFO: üöÄ Next step: cruiseplan stations -p /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_stations.pkl
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
‚úÖ PANGAEA processing completed!
   üìÑ demo_dois.txt
   üìÑ demo_stations.pkl
</pre></div></div>
</div>
</section>
</section>
<section id="Phase-2:-Cruise-configuration">
<h2>Phase 2: Cruise configuration<a class="headerlink" href="#Phase-2:-Cruise-configuration" title="Link to this heading">ÔÉÅ</a></h2>
<section id="Step-3:-Create-Station-Configuration">
<h3>Step 3: Create Station Configuration<a class="headerlink" href="#Step-3:-Create-Station-Configuration" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>CLI Equivalent</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cruiseplan<span class="w"> </span>stations<span class="w"> </span>--pangaea-file<span class="w"> </span>demo_stations.pkl<span class="w"> </span>--lat<span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">70</span><span class="w"> </span>--lon<span class="w"> </span>-60<span class="w"> </span>-30<span class="sb">`</span>
</pre></div>
</div>
<p><strong>BUT</strong> for this demo, we‚Äôll create a programmatic station configuration rather than using the interactive interface. Maybe we‚Äôll make an interactive demo to show the other options, but the interactive part runs nicely from the command line.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üó∫Ô∏è  Creating station configuration...&quot;</span><span class="p">)</span>

<span class="c1"># Create a sample cruise configuration</span>
<span class="n">cruise_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cruise_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Demo North Atlantic Survey 2025&#39;</span><span class="p">,</span>
    <span class="s1">&#39;default_vessel_speed&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
    <span class="s1">&#39;turnaround_time&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
    <span class="s1">&#39;ctd_descent_rate&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;ctd_ascent_rate&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;calculate_transfer_between_sections&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;calculate_depth_via_bathymetry&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;start_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2025-06-01T00:00:00Z&#39;</span><span class="p">,</span>

    <span class="c1"># Define stations along a transect</span>
    <span class="s1">&#39;stations&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_001&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">55.0</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;CTD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;profile&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Continental shelf station&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_002&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">57.0</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">45.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;CTD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;profile&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Slope station&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_003&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">59.0</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;CTD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;profile&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Deep water station&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_004&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">61.0</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">35.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;water_sampling&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;sampling&#39;</span><span class="p">,</span>
            <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mf">180.0</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Water sampling station&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;MOOR_001&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">60.5</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;mooring&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;deployment&#39;</span><span class="p">,</span>
            <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mf">240.0</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Mooring deployment&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_005&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">63.0</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">30.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;CTD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;profile&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Northern end station&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_006&#39;</span><span class="p">,</span>
            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">58.0</span><span class="p">,</span>
            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">42.0</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;CTD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;profile&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Return transect station&#39;</span>
        <span class="p">}</span>
    <span class="p">],</span>

    <span class="c1"># Add scientific transit</span>
    <span class="s1">&#39;transits&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Demo_ADCP_Survey&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operation_type&#39;</span><span class="p">:</span> <span class="s1">&#39;underway&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;ADCP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;vessel_speed&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
            <span class="s1">&#39;route&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">56.0</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">48.0</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">56.0</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.0</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Zonal ADCP survey transect&#39;</span>
        <span class="p">}</span>
    <span class="p">],</span>

    <span class="c1"># Define execution order with leg-based port definitions</span>
    <span class="s1">&#39;legs&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Demo_Survey&#39;</span><span class="p">,</span>
            <span class="s1">&#39;departure_port&#39;</span><span class="p">:</span> <span class="s1">&#39;port_st_johns&#39;</span><span class="p">,</span>
            <span class="s1">&#39;arrival_port&#39;</span><span class="p">:</span> <span class="s1">&#39;port_st_johns&#39;</span><span class="p">,</span>
            <span class="s1">&#39;first_waypoint&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_001&#39;</span><span class="p">,</span>
            <span class="s1">&#39;last_waypoint&#39;</span><span class="p">:</span> <span class="s1">&#39;STN_006&#39;</span><span class="p">,</span>
            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;STN_001&#39;</span><span class="p">,</span> <span class="s1">&#39;STN_002&#39;</span><span class="p">,</span> <span class="s1">&#39;STN_003&#39;</span><span class="p">,</span> <span class="s1">&#39;Demo_ADCP_Survey&#39;</span><span class="p">,</span> <span class="s1">&#39;STN_004&#39;</span><span class="p">,</span> <span class="s1">&#39;MOOR_001&#39;</span><span class="p">,</span> <span class="s1">&#39;STN_005&#39;</span><span class="p">,</span> <span class="s1">&#39;STN_006&#39;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Save configuration</span>
<span class="n">config_file</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;demo_cruise.yaml&quot;</span>
<span class="n">save_yaml</span><span class="p">(</span><span class="n">cruise_config</span><span class="p">,</span> <span class="n">config_file</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Station configuration created&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Configuration saved to: </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Stations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cruise_config</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Transits: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cruise_config</span><span class="p">[</span><span class="s1">&#39;transits&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Legs: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cruise_config</span><span class="p">[</span><span class="s1">&#39;legs&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Saved configuration to: ../tests_output/demo/demo_cruise.yaml
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
üó∫Ô∏è  Creating station configuration...
‚úÖ Station configuration created
   Configuration saved to: ../tests_output/demo/demo_cruise.yaml
   Stations: 7
   Transits: 1
   Legs: 1
</pre></div></div>
</div>
</section>
<section id="Step-3.5:-Manually-edit-configuration">
<h3>Step 3.5: Manually edit configuration<a class="headerlink" href="#Step-3.5:-Manually-edit-configuration" title="Link to this heading">ÔÉÅ</a></h3>
<p>The cruise configuration in <code class="docutils literal notranslate"><span class="pre">stations.yaml</span></code> will have some default values that need to be manually updated. These include the <code class="docutils literal notranslate"><span class="pre">departure_port</span></code> and <code class="docutils literal notranslate"><span class="pre">arrival_port</span></code> within the cruise leg definition. Default values are called ‚Äúport_update‚Äù, but can be replaced using values from the catalog of ports.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">legs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Interactive_Survey</span>
<span class="w">    </span><span class="nt">departure_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port_update</span>
<span class="w">    </span><span class="nt">arrival_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port_update</span>
<span class="w">    </span><span class="nt">first_waypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STN_001</span>
<span class="w">    </span><span class="nt">last_waypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STN_002</span>
<span class="w">    </span><span class="nt">strategy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sequential</span>
<span class="w">    </span><span class="nt">activities</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STN_001</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STN_002</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Transit_01</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Area_01</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using cruiseplan.utils.global_ports with get_available_ports() and list_ports_in_region()</span>

<span class="n">ports</span> <span class="o">=</span> <span class="n">get_available_ports</span><span class="p">()</span>

<span class="c1"># Display them nicely</span>
<span class="k">for</span> <span class="n">port_id</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">ports</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">port_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Or get ports in a specific region</span>
<span class="n">north_atlantic_ports</span> <span class="o">=</span> <span class="n">list_ports_in_region</span><span class="p">(</span>
      <span class="n">min_lat</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">max_lat</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span>
      <span class="n">min_lon</span><span class="o">=-</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">max_lon</span><span class="o">=</span><span class="mf">20.0</span>
  <span class="p">)</span>

<span class="k">for</span> <span class="n">port_id</span><span class="p">,</span> <span class="n">port_name</span> <span class="ow">in</span> <span class="n">north_atlantic_ports</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">port_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">port_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># If you want to add a custom port for your project</span>
<span class="n">add_custom_port</span><span class="p">(</span><span class="s2">&quot;port_my_station&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;My Research Station&quot;</span><span class="p">,</span>
    <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;My Research Station, Location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="mf">60.0</span><span class="p">,</span>
    <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">20.0</span><span class="p">,</span>
    <span class="s2">&quot;timezone&quot;</span><span class="p">:</span> <span class="s2">&quot;GMT+0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Custom research station for this cruise&quot;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
port_reykjavik: Port: Reykjavik
port_nuuk: Port: Nuuk
port_tromso: Port: Troms√∏
port_trondheim: Port: Trondheim
port_bergen: Port: Bergen
port_southampton: Port: Southampton
port_bremerhaven: Port: Bremerhaven
port_hamburg: Port: Hamburg
port_emden: Port: Emden
port_rostock: Port: Rostock
port_kiel: Port: Kiel
port_brest: Port: Brest
port_nice: Port: Nice
port_vigo: Port: Vigo
port_cadiz: Port: Cadiz
port_malaga: Port: Malaga
port_heraklion: Port: Heraklion
port_catania: Port: Catania
port_limassol: Port: Limassol
port_las_palmas: Port: Las Palmas
port_ponta_delgada: Port: Ponta Delgada
port_funchal: Port: Funchal
port_mindelo: Port: Mindelo
port_walvis_bay: Port: Walvis Bay
port_durban: Port: Durban
port_halifax: Port: Halifax
port_st_johns: Port: St. John&#39;s
port_vancouver: Port: Vancouver
port_woods_hole: Port: Woods Hole
port_san_diego: Port: San Diego
port_astoria: Port: Astoria
port_honolulu: Port: Honolulu
port_ensenada: Port: Ensenada
port_balboa: Port: Balboa
port_bridgetown: Port: Bridgetown
port_rio_de_janeiro: Port: Rio de Janeiro
port_fortaleza: Port: Fortaleza
port_belem: Port: Belem
port_recife: Port: Recife
port_antofagasta: Port: Antofagasta
port_port_louis_mauritius: Port: Port Louis
port_la_reunion: Port: La Reunion
port_port_louis_seychelles: Port: Port Louis
port_colombo: Port: Colombo
port_singapore: Port: Singapore
port_yokohama: Port: Yokohama
port_fremantle: Port: Fremantle
port_wellington: Port: Wellington
port_auckland: Port: Auckland
port_papeete: Port: Papeete
port_update: Port: Reykjavik (DEFAULT in stations.yaml)
port_reykjavik: Reykjavik
port_tromso: Troms√∏
port_trondheim: Trondheim
port_bergen: Bergen
port_southampton: Southampton
port_bremerhaven: Bremerhaven
port_hamburg: Hamburg
port_emden: Emden
port_rostock: Rostock
port_kiel: Kiel
port_update: Reykjavik (DEFAULT in stations.yaml)
</pre></div></div>
</div>
</section>
<section id="Step-4:-Process-Configuration">
<h3>Step 4: Process Configuration<a class="headerlink" href="#Step-4:-Process-Configuration" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>CLI Equivalent</strong>: <code class="docutils literal notranslate"><span class="pre">cruiseplan</span> <span class="pre">enrich</span> <span class="pre">-c</span> <span class="pre">demo_cruise.yaml</span> <span class="pre">--add-depths</span> <span class="pre">--add-coords</span> <span class="pre">--expand-sections</span></code></p>
<p>Add computed data like depths, formatted coordinates, and expand CTD sections.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîß Processing configuration (enrich + validate + map)...&quot;</span><span class="p">)</span>
<span class="n">config_file</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;demo_cruise.yaml&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">process_result</span> <span class="o">=</span> <span class="n">cruiseplan</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
        <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span><span class="p">),</span>
        <span class="n">output</span><span class="o">=</span><span class="s2">&quot;demo_cruise&quot;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span>
        <span class="n">bathy_source</span><span class="o">=</span><span class="s2">&quot;etopo2022&quot;</span><span class="p">,</span>
        <span class="n">bathy_dir</span><span class="o">=</span><span class="s2">&quot;../data/bathymetry&quot;</span><span class="p">,</span>  <span class="c1"># Go up to project root, then into data</span>
        <span class="n">bathy_stride</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
        <span class="n">depth_check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="o">=</span><span class="mi">10</span>
    <span class="p">)</span>

    <span class="c1"># Extract data from result</span>
    <span class="n">cruise_config</span> <span class="o">=</span> <span class="n">process_result</span><span class="o">.</span><span class="n">config</span>
    <span class="n">generated_config_files</span> <span class="o">=</span> <span class="n">process_result</span><span class="o">.</span><span class="n">files_created</span>

    <span class="k">if</span> <span class="n">cruise_config</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Processing completed successfully!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - Configuration enriched&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - Validation passed&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">generated_config_files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üìÑ </span><span class="si">{</span><span class="n">file</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ùå Processing failed&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Processing failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: üîß Enriching cruise configuration...
INFO: üîß Enriching /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise.yaml
WARNING: ‚ö†Ô∏è Added missing field: default_distance_between_stations = 15.0 km
INFO: Saved configuration to: /tmp/tmpggsiks54.yaml
INFO: ‚úÖ Loaded bathymetry from /home/runner/work/cruiseplan/cruiseplan/data/bathymetry/ETOPO_2022_v1_60s_N90W180_bed.nc
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
üîß Processing configuration (enrich + validate + map)...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Saved configuration to: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_enriched.yaml
INFO: ‚úÖ Configuration enriched successfully: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_enriched.yaml
INFO: ‚úÖ Validating cruise configuration...
INFO:  Validating /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_enriched.yaml
INFO: ‚úÖ Loaded bathymetry from /home/runner/work/cruiseplan/cruiseplan/data/bathymetry/ETOPO_2022_v1_60s_N90W180_bed.nc
INFO: ‚úÖ Validation passed
INFO: üó∫Ô∏è Generating cruise maps...
INFO: Display bounds: 50.0¬∞-68.0¬∞N, -55.0¬∞--25.0¬∞E
INFO: Loading bathymetry for region: 47.0¬∞-71.0¬∞N, -58.0¬∞--22.0¬∞E
INFO: ‚úÖ Loaded bathymetry from /home/runner/work/cruiseplan/cruiseplan/data/bathymetry/ETOPO_2022_v1_60s_N90W180_bed.nc
INFO: Added bathymetry contours covering full region
INFO: Map displayed with 7 points, 1 lines, 0 areas
INFO: Map saved to /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_map.png
INFO: ‚úÖ Processing workflow completed successfully!
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
‚úÖ Processing completed successfully!
   - Configuration enriched
   - Validation passed
   üìÑ /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_enriched.yaml
   üìÑ /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_map.png
</pre></div></div>
</div>
</section>
</section>
<section id="Phase-3:-Cruise-scheduling-+-outputs">
<h2>Phase 3: Cruise scheduling + outputs<a class="headerlink" href="#Phase-3:-Cruise-scheduling-+-outputs" title="Link to this heading">ÔÉÅ</a></h2>
<section id="Step-5:-Generate-Schedule">
<h3>Step 5: Generate Schedule<a class="headerlink" href="#Step-5:-Generate-Schedule" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>CLI Equivalent</strong>: <code class="docutils literal notranslate"><span class="pre">cruiseplan</span> <span class="pre">schedule</span> <span class="pre">-c</span> <span class="pre">demo_cruise_enriched.yaml</span> <span class="pre">-o</span> <span class="pre">tests_output/demo/</span> <span class="pre">--format</span> <span class="pre">all</span></code></p>
<p>Generate the complete cruise timeline and output files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the enriched config file from the previous step</span>
<span class="n">enriched_config_file</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">generated_config_files</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;enriched.yaml&#39;</span><span class="p">):</span>
        <span class="n">enriched_config_file</span> <span class="o">=</span> <span class="n">files</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">enriched_config_file</span><span class="p">:</span>
    <span class="n">enriched_config_file</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;demo_cruise_enriched.yaml&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üìÖ Generating cruise schedule...&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Generate the schedule with multiple output formats using new API</span>
    <span class="n">schedule_result</span> <span class="o">=</span> <span class="n">cruiseplan</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span>
        <span class="n">config_file</span><span class="o">=</span><span class="n">enriched_config_file</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;../tests_output/demo&quot;</span><span class="p">,</span>
        <span class="n">output</span><span class="o">=</span><span class="s2">&quot;demo_cruise&quot;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;html,csv,netcdf&quot;</span><span class="p">,</span>
        <span class="n">leg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">derive_netcdf</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Extract data from result</span>
    <span class="n">timeline</span> <span class="o">=</span> <span class="n">schedule_result</span><span class="o">.</span><span class="n">timeline</span>
    <span class="n">generated_files</span> <span class="o">=</span> <span class="n">schedule_result</span><span class="o">.</span><span class="n">files_created</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Schedule generated successfully!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">timeline</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Timeline object created with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">timeline</span><span class="p">)</span><span class="si">}</span><span class="s2"> activities&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Output files in: ../tests_output/demo/&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Generated formats: HTML, CSV, NetCDF&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">generated_files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è No timeline generated&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Schedule generation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Optionally show the full traceback for debugging</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: üìÖ Generating schedule from /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_enriched.yaml
INFO: üåê HTML Generator: Starting generation of /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.html
INFO:    Timeline contains 19 activities
INFO:    Adding to ports: St. John&#39;s (activity=Port, op_class=PointOperation, op_type=port)
INFO:    Adding to stations (other): STN_001 (activity=Station, op_class=PointOperation, op_type=CTD)
INFO:    Adding to stations (other): STN_002 (activity=Station, op_class=PointOperation, op_type=CTD)
INFO:    Adding to stations (other): STN_003 (activity=Station, op_class=PointOperation, op_type=CTD)
INFO:    Adding to scientific_transits: Demo_ADCP_Survey (activity=Line, op_class=LineOperation, op_type=underway)
INFO:    Adding to stations (other): STN_004 (activity=Station, op_class=PointOperation, op_type=water_sampling)
INFO:    Adding to moorings: MOOR_001 (activity=Mooring, op_class=PointOperation, op_type=mooring)
INFO:    Adding to stations (other): STN_005 (activity=Station, op_class=PointOperation, op_type=CTD)
INFO:    Adding to stations (other): STN_006 (activity=Station, op_class=PointOperation, op_type=CTD)
INFO:    Adding to ports: St. John&#39;s (activity=Port, op_class=PointOperation, op_type=port)
INFO: üîç Cruise-level operation counts:
INFO:    Stations: 6
INFO:    Moorings: 1
INFO:    Scientific transits (surveys): 1
INFO:    Area operations: 0
INFO:    Total scientific operations: 8
INFO:    Port activities: 2
INFO:    Within-area transits: 7
INFO: üîç Leg &#39;Demo_Survey&#39; operation counts:
INFO:    Stations: 5
INFO:    Moorings: 1
INFO:    Surveys: 1
INFO:    Areas: 0
INFO:    Total scientific operations: 8
INFO:    Total activities in leg: 19
INFO: ‚úÖ Generated HTML schedule: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.html
INFO: üìä CSV Generator: Starting generation of /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.csv
INFO:    Timeline contains 19 activities
INFO: ‚úÖ Generated CSV schedule: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.csv
INFO: üìÑ NetCDF Generator: Starting generation of /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.nc
INFO:    Timeline contains 19 activities
INFO: Generating ship schedule NetCDF: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.nc
INFO: Ship schedule NetCDF written to: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.nc
INFO: ‚úÖ Generated NetCDF schedule: /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.nc
INFO: üìÖ Schedule generation complete! Generated 3 files
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
üìÖ Generating cruise schedule...
‚úÖ Schedule generated successfully!
   Timeline object created with 19 activities
   Output files in: ../tests_output/demo/
   Generated formats: HTML, CSV, NetCDF
   - /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.html
   - /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.csv
   - /home/runner/work/cruiseplan/cruiseplan/tests_output/demo/demo_cruise_schedule.nc
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the *.nc file in generated_files list of paths (from schedule result)</span>
<span class="n">schedule_file</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">generated_files</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.nc&#39;</span><span class="p">):</span>
        <span class="n">schedule_file</span> <span class="o">=</span> <span class="n">file</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">schedule_file</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">schedule_file</span><span class="p">)</span>
    <span class="n">ds</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No NetCDF file found in generated files&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Workflow-Summary">
<h2>Workflow Summary<a class="headerlink" href="#Workflow-Summary" title="Link to this heading">ÔÉÅ</a></h2>
<p>Let‚Äôs review what we‚Äôve accomplished and check our output files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_files</span> <span class="o">=</span> <span class="n">pangaea_files</span> <span class="o">+</span> <span class="p">[</span><span class="n">config_file</span><span class="p">]</span> <span class="o">+</span> <span class="n">generated_config_files</span> <span class="o">+</span> <span class="n">generated_files</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ CruisePlan Demo Complete!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìÅ Generated files: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files in </span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üìÑ </span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
‚úÖ CruisePlan Demo Complete!
üìÅ Generated files: 8 files in demo/
   üìÑ demo_dois.txt
   üìÑ demo_stations.pkl
   üìÑ demo_cruise.yaml
   üìÑ demo_cruise_enriched.yaml
   üìÑ demo_cruise_map.png
   üìÑ demo_cruise_schedule.html
   üìÑ demo_cruise_schedule.csv
   üìÑ demo_cruise_schedule.nc
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CruisePlan v0.3.1: Unified Operations Model &mdash; CruisePlan v0.3.4 v0.3.4</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=393fce2e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=1e28cc32"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Station Picker v0.4.0: Multi-Modal Input Architecture" href="v0.4.0-station-picker-architecture.html" />
    <link rel="prev" title="Development Roadmap" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CruisePlan v0.3.4
              <img src="../_static/cruise_plan_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Workflows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html#workflow-paths">Workflow Paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html#troubleshooting">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebook Demo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../demo-output.html">CruisePlan Demo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Specifications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cruise_architecture.html">Cruise Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli_reference.html">CLI Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yaml_reference.html">YAML Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation_types.html">Operation Types Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculations.html">Calculation Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units_and_defaults.html">Units and defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="../global_ports.html">Port list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output_formats.html">Output formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help and Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocean-uhh/cruiseplan">GitHub Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocean-uhh/cruiseplan/blob/main/CONTRIBUTING.md">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_structure.html">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual_testing.html">Manual Testing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Development Roadmap</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#current-development-status">Current Development Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-3-0-current-status">v0.3.0: Current Status</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#v0-3-1-unified-operations-model">v0.3.1: Unified Operations Model</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">CruisePlan v0.3.1: Unified Operations Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#current-state-analysis">Current State Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unified-operations-model">Unified Operations Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extensible-operation-parameters-system">Extensible Operation Parameters System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unified-operation-types">Unified Operation Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#global-port-handling-decision">Global Port Handling Decision</a></li>
<li class="toctree-l4"><a class="reference internal" href="#migration-strategy">Migration Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#marine-facilities-planning-output-format">Marine Facilities Planning Output Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cli-design-pattern">CLI Design Pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="#benefits-of-unified-model">Benefits of Unified Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-timeline">Implementation Timeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-4-x-station-picker-enhancements">v0.4.x: Station Picker Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-5-0-netcdf-and-yaml-enhancements">v0.5.0: NetCDF and YAML Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-6-0-route-optimization">v0.6.0: Route optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v1-0-0-stable-release">v1.0.0: Stable Release</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#implementation-notes">Implementation Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#risk-assessment">Risk Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#contributing">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CruisePlan v0.3.4</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Development Roadmap</a></li>
      <li class="breadcrumb-item active">CruisePlan v0.3.1: Unified Operations Model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cruiseplan-v0-3-1-unified-operations-model">
<h1>CruisePlan v0.3.1: Unified Operations Model<a class="headerlink" href="#cruiseplan-v0-3-1-unified-operations-model" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This roadmap document describes planned features for v0.3.1. Implementation will begin after v0.3.0 is thoroughly tested and released to PyPI.</p>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This version unifies the operations model to handle all point-based activities (stations, moorings, ports, waypoints) consistently through the existing PointOperation infrastructure. This eliminates special-case handling and provides a cleaner, more extensible architecture.</p>
</section>
<section id="current-state-analysis">
<h2>Current State Analysis<a class="headerlink" href="#current-state-analysis" title="Link to this heading"></a></h2>
<section id="before-v0-3-1">
<h3>Before v0.3.1<a class="headerlink" href="#before-v0-3-1" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Stations</strong>: PointOperation with <code class="docutils literal notranslate"><span class="pre">op_type='station'</span></code></p></li>
<li><p><strong>Moorings</strong>: PointOperation with <code class="docutils literal notranslate"><span class="pre">op_type='mooring'</span></code>, <code class="docutils literal notranslate"><span class="pre">action='deployment'/'recovery'</span></code></p></li>
<li><p><strong>Ports</strong>: Separate PortDefinition class, referenced in leg.departure_port/arrival_port</p></li>
<li><p><strong>Waypoints</strong>: String references in leg.first_waypoint/last_waypoint</p></li>
</ul>
</section>
<section id="problems-with-current-approach">
<h3>Problems with Current Approach<a class="headerlink" href="#problems-with-current-approach" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Inconsistent handling of point-based operations</p></li>
<li><p>Special-case code for ports and waypoints</p></li>
<li><p>Limited functionality for ports/waypoints (no duration calculation, etc.)</p></li>
<li><p>Complex mapping in station picker and converters</p></li>
</ol>
</section>
</section>
<section id="unified-operations-model">
<h2>Unified Operations Model<a class="headerlink" href="#unified-operations-model" title="Link to this heading"></a></h2>
<section id="extended-operation-types-inspired-by-plancampanha">
<h3>Extended Operation Types inspired by PlanCampanha<a class="headerlink" href="#extended-operation-types-inspired-by-plancampanha" title="Link to this heading"></a></h3>
<p>Based on PlanCampanha’s multiple operation types, we need an extensible system that supports:</p>
<p><strong>Core CruisePlan Operations:</strong></p>
<ul class="simple">
<li><p>CTD, MOORING, CALIBRATION (existing)</p></li>
<li><p>PORT, WAYPOINT (new unified operations)</p></li>
</ul>
<p><strong>Extended Scientific Operations (examples from PlanCampanha):</strong></p>
<ul class="simple">
<li><p>WP2_NET, BONGO_NET, AVANI_NET (plankton/microplastics sampling)</p></li>
<li><p>BOX_CORE, GRAVITY_CORE (sediment coring)</p></li>
<li><p>ROV_OPERATION (remotely operated vehicle)</p></li>
<li><p>LANDER (autonomous seafloor equipment)</p></li>
</ul>
<p><strong>Operation Parameters &amp; Duration Calculation:</strong></p>
<p>Each operation type needs configurable parameters for duration calculation:</p>
<ul class="simple">
<li><p>Depth-dependent operations: CTD, nets, cores, ROV, lander</p></li>
<li><p>Fixed-duration operations: moorings, ports</p></li>
<li><p>Waiting operations: delays, equipment prep</p></li>
</ul>
</section>
<section id="proposed-enum-extensions">
<h3>Proposed Enum Extensions<a class="headerlink" href="#proposed-enum-extensions" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In cruiseplan/core/validation.py</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OperationTypeEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enumeration of point operation types.&quot;&quot;&quot;</span>
    <span class="c1"># Existing operations</span>
    <span class="n">CTD</span> <span class="o">=</span> <span class="s2">&quot;CTD&quot;</span>
    <span class="n">WATER_SAMPLING</span> <span class="o">=</span> <span class="s2">&quot;water_sampling&quot;</span>
    <span class="n">MOORING</span> <span class="o">=</span> <span class="s2">&quot;mooring&quot;</span>
    <span class="n">CALIBRATION</span> <span class="o">=</span> <span class="s2">&quot;calibration&quot;</span>

    <span class="c1"># v0.3.1 Unified operations</span>
    <span class="n">PORT</span> <span class="o">=</span> <span class="s2">&quot;port&quot;</span>                    <span class="c1"># Departure/arrival ports</span>
    <span class="n">WAYPOINT</span> <span class="o">=</span> <span class="s2">&quot;waypoint&quot;</span>            <span class="c1"># Navigation waypoints</span>
    <span class="n">WP2_NET</span> <span class="o">=</span> <span class="s2">&quot;wp2_net&quot;</span>             <span class="c1"># WP2 zooplankton net</span>
    <span class="n">BONGO_NET</span> <span class="o">=</span> <span class="s2">&quot;bongo_net&quot;</span>         <span class="c1"># Bongo ichthyoplankton net</span>
    <span class="n">AVANI_NET</span> <span class="o">=</span> <span class="s2">&quot;avani_net&quot;</span>         <span class="c1"># Avani microplastics net</span>
    <span class="n">BOX_CORE</span> <span class="o">=</span> <span class="s2">&quot;box_core&quot;</span>           <span class="c1"># Box sediment coring</span>
    <span class="n">GRAVITY_CORE</span> <span class="o">=</span> <span class="s2">&quot;gravity_core&quot;</span>   <span class="c1"># Gravity sediment coring</span>
    <span class="n">ROV_OPERATION</span> <span class="o">=</span> <span class="s2">&quot;rov_operation&quot;</span> <span class="c1"># ROV deployment</span>
    <span class="n">LANDER</span> <span class="o">=</span> <span class="s2">&quot;lander&quot;</span>               <span class="c1"># Seafloor lander operations</span>

    <span class="c1"># Custom/user-defined operations</span>
    <span class="n">CUSTOM</span> <span class="o">=</span> <span class="s2">&quot;custom&quot;</span>               <span class="c1"># User-defined operation types</span>
    <span class="n">UPDATE_PLACEHOLDER</span> <span class="o">=</span> <span class="s2">&quot;UPDATE-CTD-mooring-etc&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ActionEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enumeration of specific actions for operations.&quot;&quot;&quot;</span>
    <span class="n">PROFILE</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
    <span class="n">SAMPLING</span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span>
    <span class="n">DEPLOYMENT</span> <span class="o">=</span> <span class="s2">&quot;deployment&quot;</span>
    <span class="n">RECOVERY</span> <span class="o">=</span> <span class="s2">&quot;recovery&quot;</span>
    <span class="n">CALIBRATION</span> <span class="o">=</span> <span class="s2">&quot;calibration&quot;</span>
    <span class="n">DEPARTURE</span> <span class="o">=</span> <span class="s2">&quot;departure&quot;</span>          <span class="c1"># NEW for ports</span>
    <span class="n">ARRIVAL</span> <span class="o">=</span> <span class="s2">&quot;arrival&quot;</span>              <span class="c1"># NEW for ports</span>
    <span class="c1"># Line operation actions</span>
    <span class="n">ADCP</span> <span class="o">=</span> <span class="s2">&quot;ADCP&quot;</span>
    <span class="n">BATHYMETRY</span> <span class="o">=</span> <span class="s2">&quot;bathymetry&quot;</span>
    <span class="c1"># ... existing line actions</span>
</pre></div>
</div>
</section>
</section>
<section id="extensible-operation-parameters-system">
<h2>Extensible Operation Parameters System<a class="headerlink" href="#extensible-operation-parameters-system" title="Link to this heading"></a></h2>
<p>To support operation-specific duration calculations and user-defined operation types, we need a registry-based system for operation parameters.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p><strong>Fixed Duration Operations</strong>: Simple time-based operations (nets, moorings)</p></li>
<li><p><strong>Depth-Dependent Operations</strong>: CTD, cores, landers, ROV with velocity-based calculations</p></li>
<li><p><strong>Custom Duration Formulas</strong>: User-defined calculation methods</p></li>
<li><p><strong>Operation Limits</strong>: Maximum depth constraints, equipment limitations</p></li>
<li><p><strong>PlanCampanha Compatibility</strong>: Default parameters can be based on PlanCampanha values</p></li>
</ul>
<p>OperationParameters Class:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Time Unit Consistency</strong>: Need to verify internal time units - duration may be in hours while delays are in minutes. This needs to be standardized.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OperationParameters</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters for operation duration and behavior calculation.</span>
<span class="sd">    Uses YAML-compatible field names to match existing configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Fixed duration operations (hours) - matches YAML duration field</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Fixed duration in hours&quot;</span><span class="p">)</span>

    <span class="c1"># Depth-dependent parameters (matches existing calculations)</span>
    <span class="n">velocity_m_per_sec</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Deployment/recovery velocity in m/s&quot;</span><span class="p">)</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Maximum operational depth in meters&quot;</span><span class="p">)</span>

    <span class="c1"># Time delay parameters (matches existing YAML fields)</span>
    <span class="n">delay_start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Delay before operation starts in minutes&quot;</span><span class="p">)</span>
    <span class="n">delay_end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Delay after operation ends in minutes&quot;</span><span class="p">)</span>

    <span class="c1"># Custom duration calculation</span>
    <span class="n">duration_formula</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Python formula for duration calculation&quot;</span><span class="p">)</span>

    <span class="c1"># Description for documentation</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Operation description&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Example operation parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DEFAULT_PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">OperationTypeEnum</span><span class="o">.</span><span class="n">CTD</span><span class="p">:</span> <span class="n">OperationParameters</span><span class="p">(</span>
        <span class="n">velocity_m_per_sec</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>     <span class="c1"># Op.VelocityCTD (60 m/min = 1 m/s)</span>
        <span class="n">delay_end</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>              <span class="c1"># Op.TStation (delay after operation in minutes)</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Conductivity-Temperature-Depth profile&quot;</span>
    <span class="p">),</span>

    <span class="n">OperationTypeEnum</span><span class="o">.</span><span class="n">WP2_NET</span><span class="p">:</span> <span class="n">OperationParameters</span><span class="p">(</span>
        <span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>               <span class="c1"># Op.TWP2 (fixed duration)</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;WP2 net deployment for zooplankton sampling&quot;</span>
    <span class="p">),</span>

    <span class="n">OperationTypeEnum</span><span class="o">.</span><span class="n">MOORING</span><span class="p">:</span> <span class="n">OperationParameters</span><span class="p">(</span>
        <span class="n">velocity_m_per_sec</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span>    <span class="c1"># Op.VelocityMooring (55 m/min ≈ 0.92 m/s)</span>
        <span class="n">delay_end</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>              <span class="c1"># Op.TMooring (delay after operation in minutes)</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Mooring deployment or recovery&quot;</span>
    <span class="p">),</span>

    <span class="n">OperationTypeEnum</span><span class="o">.</span><span class="n">PORT</span><span class="p">:</span> <span class="n">OperationParameters</span><span class="p">(</span>
        <span class="n">duration</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>                <span class="c1"># Ports have no operation duration</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Vessel departure or arrival at port&quot;</span>
    <span class="p">),</span>

    <span class="n">OperationTypeEnum</span><span class="o">.</span><span class="n">WAYPOINT</span><span class="p">:</span> <span class="n">OperationParameters</span><span class="p">(</span>
        <span class="n">duration</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>                <span class="c1"># Default no waiting time (use delay_start for waiting)</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Navigation waypoint or waiting position&quot;</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unified-operation-types">
<h2>Unified Operation Types<a class="headerlink" href="#unified-operation-types" title="Link to this heading"></a></h2>
<p>All point-based operations now use PointOperation with consistent patterns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Activity</p></th>
<th class="head"><p>operation_type</p></th>
<th class="head"><p>action</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CTD Station</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CTD</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">profile</span></code></p></td>
<td><p>Standard oceanographic station</p></td>
</tr>
<tr class="row-odd"><td><p>Water Sampling</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">water_sampling</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sampling</span></code></p></td>
<td><p>Discrete water collection</p></td>
</tr>
<tr class="row-even"><td><p>Mooring Deploy</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mooring</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">deployment</span></code></p></td>
<td><p>Deploy mooring equipment</p></td>
</tr>
<tr class="row-odd"><td><p>Mooring Recover</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mooring</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">recovery</span></code></p></td>
<td><p>Recover mooring equipment</p></td>
</tr>
<tr class="row-even"><td><p><strong>Departure Port</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">port</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">departure</span></code></p></td>
<td><p><strong>NEW - vessel departure point</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Arrival Port</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">port</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arrival</span></code></p></td>
<td><p><strong>NEW - vessel arrival point</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>Waypoint</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">waypoint</span></code></p></td>
<td><p>None</p></td>
<td><p><strong>NEW - navigation waypoint</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Waiting Point</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">waypoint</span></code></p></td>
<td><p>None</p></td>
<td><p><strong>NEW - with delay_start for waiting</strong></p></td>
</tr>
</tbody>
</table>
</section>
<section id="global-port-handling-decision">
<h2>Global Port Handling Decision<a class="headerlink" href="#global-port-handling-decision" title="Link to this heading"></a></h2>
<p><strong>Open Design Question</strong>: For single-leg cruises that currently use global <code class="docutils literal notranslate"><span class="pre">departure_port</span></code> and <code class="docutils literal notranslate"><span class="pre">arrival_port</span></code>, we need to decide:</p>
<ol class="arabic simple">
<li><p><strong>Convert to stations</strong>: Add ports as regular stations in the stations list with <code class="docutils literal notranslate"><span class="pre">operation_type='port'</span></code></p></li>
<li><p><strong>Keep separate</strong>: Maintain ports as separate entities but implement using PointOperation internally</p></li>
</ol>
<p><strong>Current Behavior</strong>: Global ports are allowed for single-leg cruises, required at leg-level for multi-leg cruises.</p>
<p><strong>Considerations</strong>:
- Converting to stations provides complete consistency
- But changes the YAML structure for existing single-leg cruises
- Global ports might be conceptually different from “stations” to users</p>
<p><strong>Recommendation</strong>: This needs further discussion - perhaps maintain both approaches during v0.3.1 for compatibility.</p>
<p><strong>Implementation Note</strong>: Regardless of YAML representation, departure_port and arrival_port will internally use PointOperation or derive from it. A new <code class="docutils literal notranslate"><span class="pre">display_name</span></code> field should be added to PointOperation to support user-friendly port names.</p>
</section>
<section id="migration-strategy">
<h2>Migration Strategy<a class="headerlink" href="#migration-strategy" title="Link to this heading"></a></h2>
<section id="backward-compatibility-v0-3-1">
<h3>Backward Compatibility (v0.3.1)<a class="headerlink" href="#backward-compatibility-v0-3-1" title="Link to this heading"></a></h3>
<p>The system supports both old and new formats during v0.3.1 with deprecation warnings:</p>
<p>Old Format (Deprecated):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cruise</span><span class="p">:</span>
<span class="w">  </span><span class="nt">legs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Leg_01&quot;</span>
<span class="w">      </span><span class="nt">departure_port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;port_halifax&quot;</span><span class="w">    </span><span class="c1"># String reference</span>
<span class="w">      </span><span class="nt">arrival_port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;port_cadiz&quot;</span><span class="w">        </span><span class="c1"># String reference</span>
<span class="w">      </span><span class="nt">first_waypoint</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;STN_001&quot;</span><span class="w">         </span><span class="c1"># String reference</span>
<span class="w">      </span><span class="nt">last_waypoint</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;STN_005&quot;</span><span class="w">          </span><span class="c1"># String reference</span>
<span class="w">      </span><span class="nt">stations</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STN_001</span>
<span class="w">          </span><span class="c1"># ... station definition</span>
</pre></div>
</div>
<p>New Format (Recommended):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cruise</span><span class="p">:</span>
<span class="w">  </span><span class="nt">legs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Leg_01&quot;</span>
<span class="w">      </span><span class="nt">stations</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Departure port as unified station</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port_halifax</span>
<span class="w">          </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">44.6488</span>
<span class="w">          </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-63.5752</span>
<span class="w">          </span><span class="nt">operation_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port</span>
<span class="w">          </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">departure</span>

<span class="w">        </span><span class="c1"># Regular stations</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">STN_001</span>
<span class="w">          </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45.0</span>
<span class="w">          </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-60.0</span>
<span class="w">          </span><span class="nt">operation_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CTD</span>
<span class="w">          </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">profile</span>

<span class="w">        </span><span class="c1"># Waypoint with waiting time</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WAIT_001</span>
<span class="w">          </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">44.5</span>
<span class="w">          </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-61.0</span>
<span class="w">          </span><span class="nt">operation_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">waypoint</span>
<span class="w">          </span><span class="nt">delay_start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12.0</span><span class="w">  </span><span class="c1"># Wait 12 hours before next operation</span>
<span class="w">          </span><span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Wait</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">weather</span><span class="nv"> </span><span class="s">window&quot;</span>

<span class="w">        </span><span class="c1"># Arrival port as unified station</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port_cadiz</span>
<span class="w">          </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">36.5271</span>
<span class="w">          </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-6.2886</span>
<span class="w">          </span><span class="nt">operation_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port</span>
<span class="w">          </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arrival</span>
</pre></div>
</div>
</section>
</section>
<section id="marine-facilities-planning-output-format">
<h2>Marine Facilities Planning Output Format<a class="headerlink" href="#marine-facilities-planning-output-format" title="Link to this heading"></a></h2>
<section id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Marine Facilities Planning (<a class="reference external" href="https://www.marinefacilitiesplanning.com">https://www.marinefacilitiesplanning.com</a>) requires a specific CSV format for cruise planning integration. This format uses semicolon-delimited fields with simplified operation type categories.</p>
</section>
<section id="mfp-format-specification">
<h3>MFP Format Specification<a class="headerlink" href="#mfp-format-specification" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Station Type;Name;Latitude;Longitude
Waypoint;Waypoint;28.49610;-16.11910
Sampling Station;24-Pies433;29.16670;-18.48630
Sampling Station;24-Zoo;29.16670;-18.49630
Mooring;EBC7;28.67890;-13.08620
</pre></div>
</div>
<p><strong>Field Definitions:</strong></p>
<ul class="simple">
<li><p><strong>Station Type</strong>: Simplified operation category (see mapping below)</p></li>
<li><p><strong>Name</strong>: Station/operation identifier</p></li>
<li><p><strong>Latitude</strong>: Decimal degrees latitude</p></li>
<li><p><strong>Longitude</strong>: Decimal degrees longitude</p></li>
</ul>
</section>
<section id="operation-type-mapping">
<h3>Operation Type Mapping<a class="headerlink" href="#operation-type-mapping" title="Link to this heading"></a></h3>
<p>CruisePlan’s unified operations map to MFP station types as follows:</p>
</section>
</section>
<section id="cli-design-pattern">
<h2>CLI Design Pattern<a class="headerlink" href="#cli-design-pattern" title="Link to this heading"></a></h2>
<p>Following the established pattern, CLI commands should be thin wrappers around underlying API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># cruiseplan/cli/stations.py - Example wrapper pattern</span>
<span class="c1"># Should delegate to underlying API classes</span>

<span class="k">def</span><span class="w"> </span><span class="nf">interactive_station_picker</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CLI wrapper for interactive station picker.&quot;&quot;&quot;</span>

    <span class="c1"># Import the API class</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">cruiseplan.interactive.station_picker_api</span><span class="w"> </span><span class="kn">import</span> <span class="n">StationPickerAPI</span>

    <span class="c1"># Create API instance</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">StationPickerAPI</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="c1"># Delegate to API method</span>
    <span class="k">return</span> <span class="n">api</span><span class="o">.</span><span class="n">run_interactive_mode</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1"># The actual implementation should be in:</span>
<span class="c1"># cruiseplan/interactive/station_picker_api.py (new)</span>
</pre></div>
</div>
</section>
<section id="benefits-of-unified-model">
<h2>Benefits of Unified Model<a class="headerlink" href="#benefits-of-unified-model" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Consistent Architecture</strong></p>
<ul class="simple">
<li><p>All point operations use PointOperation infrastructure</p></li>
<li><p>Consistent validation, serialization, and processing</p></li>
<li><p>Eliminates special-case handling in converters and UI</p></li>
</ul>
</li>
<li><p><strong>Enhanced Functionality</strong></p>
<ul class="simple">
<li><p>Ports and waypoints now support all PointOperation features:</p>
<ul>
<li><p>Duration calculation</p></li>
<li><p>Position validation</p></li>
<li><p>Depth assignment</p></li>
<li><p>Comment/metadata support</p></li>
<li><p>Timeline integration</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Simplified Converters</strong></p>
<ul class="simple">
<li><p>PlanCampanha converter maps directly to unified operations</p></li>
<li><p>Station picker handles all types consistently</p></li>
<li><p>No special port/waypoint handling needed</p></li>
</ul>
</li>
<li><p><strong>Future Extensibility</strong></p>
<ul class="simple">
<li><p>Easy to add new operation types (e.g., <code class="docutils literal notranslate"><span class="pre">CALIBRATION</span></code>, <code class="docutils literal notranslate"><span class="pre">SURVEY_MARKER</span></code>)</p></li>
<li><p>Consistent pattern for actions (e.g., <code class="docutils literal notranslate"><span class="pre">ANCHOR</span></code>, <code class="docutils literal notranslate"><span class="pre">DRIFT</span></code>)</p></li>
<li><p>Metadata fields can be added uniformly</p></li>
</ul>
</li>
<li><p><strong>Better User Experience</strong></p>
<ul class="simple">
<li><p>Ports and waypoints appear in normal station lists</p></li>
<li><p>Consistent editing and visualization</p></li>
<li><p>Timeline includes all activities in proper sequence</p></li>
</ul>
</li>
</ol>
</section>
<section id="implementation-timeline">
<h2>Implementation Timeline<a class="headerlink" href="#implementation-timeline" title="Link to this heading"></a></h2>
<section id="phase-1-core-infrastructure">
<h3>Phase 1: Core Infrastructure<a class="headerlink" href="#phase-1-core-infrastructure" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>[ ] Add PORT and WAYPOINT to OperationTypeEnum</p></li>
<li><p>[ ] Add DEPARTURE and ARRIVAL to ActionEnum</p></li>
<li><p>[ ] Create OperationParameters and OperationTypeRegistry</p></li>
<li><p>[ ] Update StationDefinition validation with new fields</p></li>
<li><p>[ ] Create migration helper functions</p></li>
</ul>
</section>
<section id="phase-2-scheduler-integration">
<h3>Phase 2: Scheduler Integration<a class="headerlink" href="#phase-2-scheduler-integration" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>[ ] Update scheduler to handle unified operations</p></li>
<li><p>[ ] Integrate OperationTypeRegistry for duration calculation</p></li>
<li><p>[ ] Add deprecation warnings for old format</p></li>
<li><p>[ ] Test with existing YAML files</p></li>
<li><p>[ ] Verify backward compatibility</p></li>
</ul>
</section>
<section id="phase-3-extended-operations">
<h3>Phase 3: Extended Operations<a class="headerlink" href="#phase-3-extended-operations" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>[ ] Add extended operation types (WP2_NET, BONGO_NET, etc.)</p></li>
<li><p>[ ] Implement custom operation registration</p></li>
<li><p>[ ] Update duration calculation with configurable parameters</p></li>
<li><p>[ ] Add PlanCampanha-compatible defaults</p></li>
</ul>
</section>
<section id="phase-4-marine-facilities-planning-output-format">
<h3>Phase 4: Marine Facilities Planning Output Format<a class="headerlink" href="#phase-4-marine-facilities-planning-output-format" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>[ ] Add Marine Facilities Planning CSV output format</p></li>
<li><p>[ ] Implement operation type mapping for MFP format</p></li>
<li><p>[ ] Update timeline generators to support MFP export</p></li>
<li><p>[ ] Add MFP format to CLI output options</p></li>
</ul>
</section>
<section id="phase-5-documentation-examples-v0-3-1">
<h3>Phase 5: Documentation &amp; Examples (v0.3.1)<a class="headerlink" href="#phase-5-documentation-examples-v0-3-1" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>[ ] Update YAML examples to show new format</p></li>
<li><p>[ ] Document migration path and extended operations</p></li>
<li><p>[ ] Update API documentation with new output formats</p></li>
<li><p>[ ] Add migration guide and custom operation examples</p></li>
</ul>
<p>This unified approach provides a solid foundation for the enhanced station picker while maintaining backward compatibility and supporting extensibility for custom operation types and parameters.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Development Roadmap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="v0.4.0-station-picker-architecture.html" class="btn btn-neutral float-right" title="Station Picker v0.4.0: Multi-Modal Input Architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
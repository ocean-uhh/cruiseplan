

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Station Picker v0.4.2: Text Input Capabilities &mdash; CruisePlan v0.3.4 v0.3.4.post1.dev3</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=393fce2e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=901e0047"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Station Picker v0.4.3: Batch Input and PlanCampanha Format Support" href="v0.4.3-batch-input.html" />
    <link rel="prev" title="Station Picker v0.4.1: YAML Loading and Round-Trip Editing" href="v0.4.1-yaml-round-trip.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CruisePlan v0.3.4
              <img src="../_static/cruise_plan_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Workflows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html#workflow-paths">Workflow Paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_workflows.html#troubleshooting">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebook Demo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../demo-output.html">CruisePlan Demo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Specifications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cruise_architecture.html">Cruise Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli_reference.html">CLI Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yaml_reference.html">YAML Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation_types.html">Operation Types Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculations.html">Calculation Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units_and_defaults.html">Units and defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="../global_ports.html">Port list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output_formats.html">Output formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help and Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocean-uhh/cruiseplan">GitHub Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocean-uhh/cruiseplan/blob/main/CONTRIBUTING.md">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_structure.html">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual_testing.html">Manual Testing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Development Roadmap</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#current-development-status">Current Development Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-3-0-current-status">v0.3.0: Current Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-3-1-unified-operations-model">v0.3.1: Unified Operations Model</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#v0-4-x-station-picker-enhancements">v0.4.x: Station Picker Enhancements</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="v0.4.0-station-picker-architecture.html">Station Picker v0.4.0: Multi-Modal Input Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="v0.4.1-yaml-round-trip.html">Station Picker v0.4.1: YAML Loading and Round-Trip Editing</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Station Picker v0.4.2: Text Input Capabilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#phase-2-text-based-coordinate-entry">Phase 2: Text-Based Coordinate Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-architecture">Core Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coordinate-format-support">Coordinate Format Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#input-validation">Input Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coordinate-input-validation">Coordinate Input Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#textinputhandler-integration">TextInputHandler Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-interface-design">User Interface Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-values-and-consistency">Default Values and Consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operation-type-integration">Operation Type Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage-flows">Example Usage Flows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#benefits-and-integration">Benefits and Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-structure">File Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="v0.4.3-batch-input.html">Station Picker v0.4.3: Batch Input and PlanCampanha Format Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-5-0-netcdf-and-yaml-enhancements">v0.5.0: NetCDF and YAML Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v0-6-0-route-optimization">v0.6.0: Route optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#v1-0-0-stable-release">v1.0.0: Stable Release</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#implementation-notes">Implementation Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#risk-assessment">Risk Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#contributing">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CruisePlan v0.3.4</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Development Roadmap</a></li>
      <li class="breadcrumb-item active">Station Picker v0.4.2: Text Input Capabilities</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="station-picker-v0-4-2-text-input-capabilities">
<h1>Station Picker v0.4.2: Text Input Capabilities<a class="headerlink" href="#station-picker-v0-4-2-text-input-capabilities" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This roadmap document describes the text-based coordinate entry features planned for v0.4.2, building on the v0.4.0 architecture and v0.4.1 YAML integration.</p>
</div>
<section id="phase-2-text-based-coordinate-entry">
<h2>Phase 2: Text-Based Coordinate Entry<a class="headerlink" href="#phase-2-text-based-coordinate-entry" title="Link to this heading"></a></h2>
<section id="design-requirements">
<h3>Design Requirements<a class="headerlink" href="#design-requirements" title="Link to this heading"></a></h3>
<p>Based on user specifications:</p>
<ol class="arabic simple">
<li><p><strong>Coordinate formats</strong>: Support ONLY decimal degrees OR degrees + decimal minutes (no DMS)</p></li>
<li><p><strong>Input fields</strong>: Separate boxes for lat[deg], lat[min], lon[deg], lon[min]</p></li>
<li><p><strong>Station names</strong>: Required for all operations</p></li>
<li><p><strong>Multi-point support</strong>: Lines and areas need multiple coordinate entries</p></li>
<li><p><strong>Interactive flow</strong>: Add points iteratively with “Add Point” and “Done” controls</p></li>
</ol>
</section>
</section>
<section id="core-architecture">
<h2>Core Architecture<a class="headerlink" href="#core-architecture" title="Link to this heading"></a></h2>
<section id="text-input-widget-system">
<h3>Text Input Widget System<a class="headerlink" href="#text-input-widget-system" title="Link to this heading"></a></h3>
<section id="coordinate-input-panel">
<h4>Coordinate Input Panel<a class="headerlink" href="#coordinate-input-panel" title="Link to this heading"></a></h4>
<p>Panel for entering coordinates in either decimal degrees or degrees/minutes format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># cruiseplan/interactive/text_input_widget.py</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CoordinateInputPanel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Panel for entering coordinates in either decimal degrees or degrees/minutes format.</span>

<span class="sd">    Provides four text boxes for flexible coordinate entry:</span>
<span class="sd">    - lat_deg, lat_min, lon_deg, lon_min</span>
<span class="sd">    - Supports both decimal degrees (lat_min/lon_min = 0) and degrees/minutes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">on_coordinate_change</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_coordinate_change</span> <span class="o">=</span> <span class="n">on_coordinate_change</span>

        <span class="c1"># Text boxes for coordinate entry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat_deg_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat_min_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lon_deg_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lon_min_box</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_lat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_lon</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the coordinate input text boxes.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current coordinates as (lat, lon) in decimal degrees.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear all text boxes.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set coordinates from decimal degrees.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="station-input-widgets">
<h4>Station Input Widgets<a class="headerlink" href="#station-input-widgets" title="Link to this heading"></a></h4>
<p>Specialized widgets for different operation types:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">StationInputWidget</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Widget for entering single stations (CTD, moorings, ports, waypoints).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">data_manager</span><span class="p">:</span> <span class="n">InteractiveDataManager</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span> <span class="o">=</span> <span class="n">data_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_panel</span> <span class="o">=</span> <span class="n">CoordinateInputPanel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="c1"># Additional controls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operation_type_selector</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_selector</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the complete station input interface.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_station</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add station using current input values.&quot;&quot;&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LineInputWidget</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Widget for entering line operations (transits, sections).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">data_manager</span><span class="p">:</span> <span class="n">InteractiveDataManager</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span> <span class="o">=</span> <span class="n">data_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_panel</span> <span class="o">=</span> <span class="n">CoordinateInputPanel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of (lat, lon) tuples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_point_button</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_line_button</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points_display</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add current coordinates to the line.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">finish_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Complete the line and create LineOperation.&quot;&quot;&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AreaInputWidget</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Widget for entering area operations (survey areas).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">data_manager</span><span class="p">:</span> <span class="n">InteractiveDataManager</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span> <span class="o">=</span> <span class="n">data_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_panel</span> <span class="o">=</span> <span class="n">CoordinateInputPanel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_point_button</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_area_button</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points_display</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_boundary_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add current coordinates to the area boundary.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Complete the area and create AreaOperation.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="coordinate-format-support">
<h2>Coordinate Format Support<a class="headerlink" href="#coordinate-format-support" title="Link to this heading"></a></h2>
<section id="integration-with-coordinates-py">
<h3>Integration with coordinates.py<a class="headerlink" href="#integration-with-coordinates-py" title="Link to this heading"></a></h3>
<p>Directly uses existing coordinate conversion utilities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uses existing cruiseplan/utils/coordinates.py functions directly</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cruiseplan.utils.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">degrees_minutes_to_decimal</span><span class="p">,</span>
    <span class="n">decimal_to_degrees_minutes</span><span class="p">,</span>
    <span class="n">validate_latitude</span><span class="p">,</span>
    <span class="n">validate_longitude</span>
<span class="p">)</span>

<span class="c1"># In CoordinateInputPanel.get_coordinates():</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current coordinates as (lat, lon) in decimal degrees.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Parse input values</span>
        <span class="n">lat_deg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_deg_box</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_deg_box</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="n">lat_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_min_box</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_min_box</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="n">lon_deg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_deg_box</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_deg_box</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="n">lon_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_min_box</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_min_box</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="mf">0.0</span>

        <span class="c1"># Convert to decimal degrees using existing functions</span>
        <span class="k">if</span> <span class="n">lat_min</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">lat_decimal</span> <span class="o">=</span> <span class="n">degrees_minutes_to_decimal</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">),</span> <span class="n">lat_min</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lat_decimal</span> <span class="o">=</span> <span class="n">lat_deg</span>

        <span class="k">if</span> <span class="n">lon_min</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">lon_decimal</span> <span class="o">=</span> <span class="n">degrees_minutes_to_decimal</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lon_deg</span><span class="p">),</span> <span class="n">lon_min</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lon_decimal</span> <span class="o">=</span> <span class="n">lon_deg</span>

        <span class="c1"># Validate using existing functions</span>
        <span class="n">validate_latitude</span><span class="p">(</span><span class="n">lat_decimal</span><span class="p">)</span>
        <span class="n">validate_longitude</span><span class="p">(</span><span class="n">lon_decimal</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">lat_decimal</span><span class="p">,</span> <span class="n">lon_decimal</span>

    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># In CoordinateInputPanel.set_coordinates():</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set coordinates from decimal degrees using existing conversion.&quot;&quot;&quot;</span>
    <span class="n">lat_deg</span><span class="p">,</span> <span class="n">lat_min</span> <span class="o">=</span> <span class="n">decimal_to_degrees_minutes</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">lon_deg</span><span class="p">,</span> <span class="n">lon_min</span> <span class="o">=</span> <span class="n">decimal_to_degrees_minutes</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lat_deg_box</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lat_min_box</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lat_min</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lon_deg_box</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lon_deg</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lon_min_box</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lon_min</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="input-validation">
<h2>Input Validation<a class="headerlink" href="#input-validation" title="Link to this heading"></a></h2>
<section id="station-name-validation">
<h3>Station Name Validation<a class="headerlink" href="#station-name-validation" title="Link to this heading"></a></h3>
<p>Enforces naming rules for consistent operation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">class</span><span class="w"> </span><span class="nc">StationNameValidator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates station names according to CruisePlan rules.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate station name.</span>

<span class="sd">        Rules:</span>
<span class="sd">        - No spaces or hyphens (replaced with underscores)</span>
<span class="sd">        - Not empty</span>
<span class="sd">        - No special characters except underscores</span>

<span class="sd">        Returns (is_valid, cleaned_name)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Name cannot be empty&quot;</span>

        <span class="c1"># Clean name - replace spaces and hyphens with underscores</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\s\-]+&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

        <span class="c1"># Check for invalid characters</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[a-zA-Z0-9_]+$&#39;</span><span class="p">,</span> <span class="n">cleaned</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Invalid characters in name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cleaned</span>
</pre></div>
</div>
</section>
</section>
<section id="coordinate-input-validation">
<h2>Coordinate Input Validation<a class="headerlink" href="#coordinate-input-validation" title="Link to this heading"></a></h2>
<p>Comprehensive validation for the dual-format coordinate input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CoordinateInputValidator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates coordinate input in degrees/minutes format.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_coordinate_input</span><span class="p">(</span><span class="n">deg_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">min_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">coord_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate coordinate input supporting both formats.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        deg_str : str</span>
<span class="sd">            Degrees field input</span>
<span class="sd">        min_str : str</span>
<span class="sd">            Minutes field input</span>
<span class="sd">        coord_type : str</span>
<span class="sd">            &#39;latitude&#39; or &#39;longitude&#39; for appropriate range checking</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple[bool, str, Optional[float]]</span>
<span class="sd">            (is_valid, error_message, decimal_coordinate)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Clean inputs</span>
            <span class="n">deg_str</span> <span class="o">=</span> <span class="n">deg_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">min_str</span> <span class="o">=</span> <span class="n">min_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="c1"># Handle empty inputs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">deg_str</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> degrees cannot be empty&quot;</span><span class="p">,</span> <span class="kc">None</span>

            <span class="c1"># Parse based on whether minutes are provided</span>
            <span class="k">if</span> <span class="n">min_str</span><span class="p">:</span>  <span class="c1"># Degrees + decimal minutes format</span>
                <span class="c1"># Degrees must be integer when minutes provided</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">deg_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">deg_str</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> degrees must be integer when minutes are provided&quot;</span><span class="p">,</span> <span class="kc">None</span>

                <span class="c1"># Minutes can be integer or decimal</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">min_str</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> minutes must be numeric&quot;</span><span class="p">,</span> <span class="kc">None</span>

                <span class="c1"># Validate minutes range</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">min_val</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> minutes must be between 0 and 60&quot;</span><span class="p">,</span> <span class="kc">None</span>

                <span class="c1"># Sign consistency check</span>
                <span class="k">if</span> <span class="n">deg_val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">min_val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Warning: Negative </span><span class="si">{</span><span class="n">coord_type</span><span class="si">}</span><span class="s2"> degrees but positive minutes - did you mean negative minutes?&quot;</span><span class="p">,</span> <span class="kc">None</span>
                <span class="k">elif</span> <span class="n">deg_val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Warning: Positive </span><span class="si">{</span><span class="n">coord_type</span><span class="si">}</span><span class="s2"> degrees but negative minutes - check sign consistency&quot;</span><span class="p">,</span> <span class="kc">None</span>

                <span class="c1"># Convert to decimal</span>
                <span class="n">decimal_coord</span> <span class="o">=</span> <span class="n">degrees_minutes_to_decimal</span><span class="p">(</span><span class="n">deg_val</span><span class="p">,</span> <span class="n">min_val</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Decimal degrees format</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">decimal_coord</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">deg_str</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> must be numeric&quot;</span><span class="p">,</span> <span class="kc">None</span>

            <span class="c1"># Validate final coordinate range</span>
            <span class="k">if</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span>
                <span class="n">validate_latitude</span><span class="p">(</span><span class="n">decimal_coord</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">validate_longitude</span><span class="p">(</span><span class="n">decimal_coord</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">decimal_coord</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_for_input</span><span class="p">(</span><span class="n">decimal_coord</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format decimal coordinate for input fields with proper precision.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">decimal_coord</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">:</span>  <span class="c1"># Longitude &gt; 3 digits</span>
            <span class="c1"># Use degrees/minutes format for large values</span>
            <span class="n">deg</span><span class="p">,</span> <span class="n">min_val</span> <span class="o">=</span> <span class="n">decimal_to_degrees_minutes</span><span class="p">(</span><span class="n">decimal_coord</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">deg</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">min_val</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use decimal degrees with 5 decimal places</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">decimal_coord</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<section id="text-box-sizing">
<h3>Text Box Sizing<a class="headerlink" href="#text-box-sizing" title="Link to this heading"></a></h3>
<p>Ensure adequate field widths for different coordinate formats:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Text box configuration for coordinate input</span>
<span class="n">TEXTBOX_CONFIG</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;lat_deg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Lat°&#39;</span><span class="p">},</span>     <span class="c1"># -90 to 90 or -90.12345</span>
    <span class="s1">&#39;lat_min&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Lat&#39;&quot;</span><span class="p">},</span>     <span class="c1"># 0.0000 to 59.9999</span>
    <span class="s1">&#39;lon_deg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Lon°&#39;</span><span class="p">},</span>     <span class="c1"># -180 to 180 or -180.12345</span>
    <span class="s1">&#39;lon_min&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Lon&#39;&quot;</span><span class="p">},</span>     <span class="c1"># 0.0000 to 59.9999</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="real-time-validation">
<h3>Real-time Validation<a class="headerlink" href="#real-time-validation" title="Link to this heading"></a></h3>
<p>Provide immediate feedback during input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_coordinate_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate coordinates in real-time as user types.&quot;&quot;&quot;</span>
    <span class="c1"># Validate latitude</span>
    <span class="n">lat_valid</span><span class="p">,</span> <span class="n">lat_error</span><span class="p">,</span> <span class="n">lat_decimal</span> <span class="o">=</span> <span class="n">CoordinateInputValidator</span><span class="o">.</span><span class="n">validate_coordinate_input</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat_deg_box</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_min_box</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Validate longitude</span>
    <span class="n">lon_valid</span><span class="p">,</span> <span class="n">lon_error</span><span class="p">,</span> <span class="n">lon_decimal</span> <span class="o">=</span> <span class="n">CoordinateInputValidator</span><span class="o">.</span><span class="n">validate_coordinate_input</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lon_deg_box</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_min_box</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Update UI feedback</span>
    <span class="k">if</span> <span class="n">lat_valid</span> <span class="ow">and</span> <span class="n">lon_valid</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;✓ Coordinates valid&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_lat</span> <span class="o">=</span> <span class="n">lat_decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_lon</span> <span class="o">=</span> <span class="n">lon_decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="n">lat_error</span> <span class="ow">or</span> <span class="n">lon_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠ </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="textinputhandler-integration">
<h2>TextInputHandler Integration<a class="headerlink" href="#textinputhandler-integration" title="Link to this heading"></a></h2>
<section id="integration-with-v0-4-0-architecture">
<h3>Integration with v0.4.0 Architecture<a class="headerlink" href="#integration-with-v0-4-0-architecture" title="Link to this heading"></a></h3>
<p>The text input functionality integrates with the v0.4.0 architecture through a specialized input handler:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># cruiseplan/interactive/text_input_handler.py</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TextInputHandler</span><span class="p">(</span><span class="n">InputHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle text-based coordinate entry.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_manager</span><span class="p">:</span> <span class="n">InteractiveDataManager</span><span class="p">,</span> <span class="n">text_ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data_manager</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_ax</span> <span class="o">=</span> <span class="n">text_ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_mode</span> <span class="o">=</span> <span class="s2">&quot;station&quot;</span>  <span class="c1"># station, line, area</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Activate text input mode.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_mode_selector</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_switch_to_station_mode</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deactivate text input mode.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_switch_to_station_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switch to station input mode.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_mode</span> <span class="o">=</span> <span class="s2">&quot;station&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span> <span class="o">=</span> <span class="n">StationInputWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">create_ui</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_switch_to_line_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switch to line input mode.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_mode</span> <span class="o">=</span> <span class="s2">&quot;line&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span> <span class="o">=</span> <span class="n">LineInputWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">create_ui</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_switch_to_area_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switch to area input mode.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_mode</span> <span class="o">=</span> <span class="s2">&quot;area&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span> <span class="o">=</span> <span class="n">AreaInputWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_widget</span><span class="o">.</span><span class="n">create_ui</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="user-interface-design">
<h2>User Interface Design<a class="headerlink" href="#user-interface-design" title="Link to this heading"></a></h2>
<section id="layout-structure">
<h3>Layout Structure<a class="headerlink" href="#layout-structure" title="Link to this heading"></a></h3>
<p>The text input interface occupies a dedicated panel with organized sections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────────┐
│                    Text Input Panel                         │
├─────────────────────────────────────────────────────────────┤
│ Mode: [Station] [Line] [Area]                               │
├─────────────────────────────────────────────────────────────┤
│ Name: [________________]                                    │
├─────────────────────────────────────────────────────────────┤
│ Coordinates:                                                │
│   Lat: [___]° [_____]&#39;    Lon: [___]° [_____]&#39;             │
├─────────────────────────────────────────────────────────────┤
│ Operation Type: [&lt;default&gt; ▼]   Action: [&lt;default&gt;  ▼]     │
│ Operation depth (m): [____] (defaults to water depth)      │
├─────────────────────────────────────────────────────────────┤
│                    [Add Station]                            │
└─────────────────────────────────────────────────────────────┘
</pre></div>
</div>
<p>For line and area modes, additional controls appear:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────────┐
│ Current Points:                                             │
│   1. (45.000°, -60.000°)                                   │
│   2. (45.500°, -59.000°)                                   │
├─────────────────────────────────────────────────────────────┤
│ [Add Point]  [Finish Line]  [Clear All]                    │
└─────────────────────────────────────────────────────────────┘
</pre></div>
</div>
</section>
</section>
<section id="default-values-and-consistency">
<h2>Default Values and Consistency<a class="headerlink" href="#default-values-and-consistency" title="Link to this heading"></a></h2>
<section id="click-input-consistency">
<h3>Click Input Consistency<a class="headerlink" href="#click-input-consistency" title="Link to this heading"></a></h3>
<p>Text input defaults should match click input behavior:</p>
<p><strong>Default Operation Type and Action</strong>:
- <strong>Station mode</strong>: <code class="docutils literal notranslate"><span class="pre">operation_type=None</span></code>, <code class="docutils literal notranslate"><span class="pre">action=None</span></code> (system will apply defaults during processing)
- <strong>Line mode</strong>: <code class="docutils literal notranslate"><span class="pre">operation_type=None</span></code>, <code class="docutils literal notranslate"><span class="pre">action=None</span></code> (user can specify, or defaults to transit)
- <strong>Area mode</strong>: <code class="docutils literal notranslate"><span class="pre">operation_type=None</span></code>, <code class="docutils literal notranslate"><span class="pre">action=None</span></code> (user can specify, or defaults to survey)</p>
<p><strong>Default Depth</strong>:
- <strong>Operation depth</strong>: Defaults to water depth from bathymetry data if not specified
- <strong>User-specified depth</strong>: Takes precedence over bathymetry depth
- <strong>UI indication</strong>: Field shows “(defaults to water depth)” when empty</p>
<p><strong>Implementation Notes</strong>:
- Empty/None values indicate system should apply appropriate defaults
- This maintains consistency with click input where users don’t specify operation details
- Processing pipeline handles default assignment based on context</p>
</section>
</section>
<section id="operation-type-integration">
<h2>Operation Type Integration<a class="headerlink" href="#operation-type-integration" title="Link to this heading"></a></h2>
<section id="unified-operations-support">
<h3>Unified Operations Support<a class="headerlink" href="#unified-operations-support" title="Link to this heading"></a></h3>
<p>The text input system supports all unified operation types from v0.3.1+:</p>
<p><strong>Station Operations:</strong></p>
<ul class="simple">
<li><p>CTD stations with profile action</p></li>
<li><p>Moorings with deployment/recovery actions</p></li>
<li><p>Ports with departure/arrival actions</p></li>
<li><p>Waypoints (with optional delay_start for waiting)</p></li>
<li><p>Custom operation types through registry</p></li>
</ul>
<p><strong>Multi-Point Operations:</strong></p>
<ul class="simple">
<li><p>Transit lines between waypoints</p></li>
<li><p>CTD sections with automatic station expansion</p></li>
<li><p>Survey areas with boundary definitions</p></li>
</ul>
</section>
</section>
<section id="example-usage-flows">
<h2>Example Usage Flows<a class="headerlink" href="#example-usage-flows" title="Link to this heading"></a></h2>
<p>Adding a CTD Station:</p>
<ol class="arabic simple">
<li><p>Select “Station” mode</p></li>
<li><p>Enter name: “STN_045”</p></li>
<li><p>Enter coordinates: Lat: 45° 30.5’, Lon: 60° 15.2’</p></li>
<li><p>(Optional) Select operation type: “CTD”, action: “profile” (or leave as default)</p></li>
<li><p>(Optional) Enter operation depth: 2000 (or leave blank to use water depth from bathymetry)</p></li>
<li><p>Click “Add Station”</p></li>
</ol>
<p>Adding a Transit Line:</p>
<ol class="arabic simple">
<li><p>Select “Line” mode</p></li>
<li><p>Enter name: “TRANSIT_002”</p></li>
<li><p>Enter first point coordinates</p></li>
<li><p>Click “Add Point”</p></li>
<li><p>Enter second point coordinates</p></li>
<li><p>Click “Add Point”</p></li>
<li><p>Continue for additional waypoints</p></li>
<li><p>Click “Finish Line”</p></li>
</ol>
</section>
<section id="benefits-and-integration">
<h2>Benefits and Integration<a class="headerlink" href="#benefits-and-integration" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Precision Entry</strong></p>
<ul class="simple">
<li><p>Exact coordinate specification</p></li>
<li><p>Support for both decimal degrees and degrees/minutes</p></li>
<li><p>Validation prevents input errors</p></li>
</ul>
</li>
<li><p><strong>Comprehensive Operation Support</strong></p>
<ul class="simple">
<li><p>All unified operation types supported</p></li>
<li><p>Consistent with v0.3.1+ operation model</p></li>
<li><p>Custom operations through registry</p></li>
</ul>
</li>
<li><p><strong>Seamless Integration</strong></p>
<ul class="simple">
<li><p>Uses existing coordinate utilities</p></li>
<li><p>Fits v0.4.0 input handler architecture</p></li>
<li><p>Coordinates with YAML round-trip editing</p></li>
</ul>
</li>
<li><p><strong>User Flexibility</strong></p>
<ul class="simple">
<li><p>Switch between click and text input modes</p></li>
<li><p>Combine with YAML loading and editing</p></li>
<li><p>Export to multiple formats</p></li>
</ul>
</li>
</ol>
</section>
<section id="file-structure">
<h2>File Structure<a class="headerlink" href="#file-structure" title="Link to this heading"></a></h2>
<p>New files needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cruiseplan/interactive/
├── text_input_handler.py       # TextInputHandler class
└── text_input_widgets.py       # Widget classes
</pre></div>
</div>
<p>This text input system provides precise coordinate entry capabilities while maintaining consistency with CruisePlan’s unified operations model and existing coordinate handling utilities.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="v0.4.1-yaml-round-trip.html" class="btn btn-neutral float-left" title="Station Picker v0.4.1: YAML Loading and Round-Trip Editing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="v0.4.3-batch-input.html" class="btn btn-neutral float-right" title="Station Picker v0.4.3: Batch Input and PlanCampanha Format Support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>